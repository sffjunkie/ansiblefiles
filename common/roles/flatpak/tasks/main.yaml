---
- name: Flatpak | Install flatpak
  ansible.builtin.include_tasks: "{{ lookup('first_found', subtasks) }}"
  vars:
    subtasks:
      - "{{ distribution }}.yaml"
      - "{{ os_family }}.yaml"

- name: Check if flathub is alraedy installed
  ansible.builting.command:
    cmd: flatpak remotes
  register: _flatpak_remotes

- name: Add flatpak repository
  when: not 'flathub' in _flatpak_remotes.stdout_lines[1:]
  ansible.builtin.command:
    cmd: >-
      flatpak remote-add --if-not-exists
      flathub https://flathub.org/repo/flathub.flatpakrepo
